# File is automatically generated by the azure_<environment_code>op_pipelines terraform configuration
resources:
  repositories:
    - repository: ite-pipeline-templates
      type: git
      name: 'Stacks and Modules/pipeline-templates'
      ref: refs/tags/v2.7.0

parameters:
- name: terraformForceStateUnlock
  type: string
  default: 'false'
  values:
  - 'true'
  - 'false'

trigger:
  batch: true
  branches:
    include:
    - master
  paths:
    include: 
    - /infrastructure/environments/development/*
    - /infrastructure/deploy.development.yml

stages:
    
################################################# START DEPLOYMENT TO development #############################

#++++++++++++++++++++++++++ Deploying Service app_gw +++++++++++++++++++++++++++

- template: /infrastructure/pipeline_templates/terraform.deploy.template.yml@ite-pipeline-templates
  parameters:
    terraformVersion: 1.*
    terraformForceStateUnlock: ${{ parameters.terraformForceStateUnlock }}
    admiralProductCode: smartops-demo
    admiralEnvironmentCode: development
    admiralTeamCode: core
    admiralServiceCode: app_gw
    # all ADO codes are  admiral codes with hyphens replaced with underscores
    adoProductCode: smartops_demo
    adoEnvironmentCode: development
    adoTeamCode: core
    adoServiceCode: app_gw
    infraRootGitFolder: infrastructure/environments/development/app_gw
    armServiceConnection: smartops-demo-development-core-stacks
    adoAgentPool: ''
    stageDisplayName: '(development) Default'
    # if you need to introduce dependency use ADO service code
    stageDependsOnServiceCode: []
    admiralEndpoint: 'https://admiral-p.azurefd.net'

#-------------------------- End Deploying Service app_gw ------------------------


################################################# END DEPLOYMENT TO development #############################